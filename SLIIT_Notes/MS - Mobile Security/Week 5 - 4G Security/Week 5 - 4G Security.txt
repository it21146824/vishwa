I) The goals/features of LTE
  a) Packet domain services only      : Only supports IP-based services such as internet access, VoIP, video streaming, etc..
  b) High bandwidth / User throughput : Focus on high speed data transfer rates
  c) Low latency                      : Data should be transferred with low delay (milliseconds)
  d) Improved spectral efficiency     : More data can be transferred over the same frequency (Using MIMO & OFDMA)
  e) Mobility                         : Moving from one area to another without losing connectivity (handover)
  f) Multimedia broadcast/services    : Broadcasting multimedia content to multiple users simultaneously
  g) Spectrum flexibility             : The ability to use different frequency bands for different services
  h) Multi-antenna configurations     : Multiple antennas are used to improve the performance of the network
  i) Higher coverage and frequency    : The ability to use higher frequencies to increase the coverage area of the network

II) Components of the 4G/LTE architecture
	I)	Evolved UTRAN (E-UTRAN)
		a) User Equipment (UE)	                : The mobile device (smartphone, tablet, etc..)
    b) Home eNodeB Management System (HeMS) : Configures the NodeBs with operator policy, updates software, etc
		c) Evolved Node B (eNB)	                : The base station that connects the UE to the core network
				i)		Resource Management				 : Allocates resources for proper communication/handover between UE & eNB
				ii)		Admission Control					 : Allows/rejects UEs from connecting to the network
				iii)	Cell Information Broadcast : eNB transmits network status, availability & coverage details
				iv)		Application of UL QoS			 : Regulates the bandwidth usage of the UE (Uplink Quality Of Service)
				v)		Ciphering/Deciphering of User & Control Plane Data: Data sent on-air is encrypted/decrypted

	II) Evolved Packet Core (EPC)
		a) Mobility Management Entity (MME)				 : Manages the authentication, handover, security, etc of mobile devices
		b) Serving Gateway (SGW)									 : Routes and forwards data between the mobile device and the PGW
		c) Packet Data Network Gateway (PGW/PDNGW) : Connects the 4G/LTE network to external networks such as the internet
    d) Security Gateway (SeGW)                 : Securing the traffic between the LTE network and external networks (internet)
	
III) How 4G combats multipath propagation during wireless communication
	a) OFDM (Orthogonal Frequency Division Multiplexing): A frequency band is divided into multiple sub-bands
		• If a eNB has a frequency band of (0-20MHz), it can divide it into 10 sub-bands of (0-2MHz)
		• Usually only 1 sub-band is used to transmit data at a time
		• This means that users have to wait turns to send/receive data
	
	b) MIMO (Multiple Input Multiple Output): Multiple antennas (on the UE and eNB) are used to send/receive data
		• Some benefits of MIMO are:
			a) Higher data rates: More antennas means more data can be sent/received at the same time
			b) Spatial diversity: If one antenna is blocked, the other antennas can still receive data

IV) 4G access method schemes (How multiple users access the 4G network)
	a) OFDMA (Orthogonal Frequency Division Multiple Access): A multi-user version of OFDM
		• Unlike OFDM, users do not have to wait turns to send/receive data
		• This is because multiple frequency bands can be transmitted at the same time
		• Used for downlink communication (from eNB to UE)
	
	b) SC-FDMA (Single Carrier Frequency Division Multiple Access): A low-power intensive version of OFDMA
		• This technique uses less power to transmit data
		• Used for uplink communication (from UE to eNB) as this saves the battery life of the UE

V) Types of LTE handover (How a UE moves from one eNB to another)
	a) Inter eNB/Intra MME Handover								: The UE moves from one eNB to another within the same MME 
	b) Inter eNB Handover (with MME change)				: The UE moves from one eNB to another within a different MME
	c) Inter eNB Handover (with MME & S-GW change): The UE moves from one eNB to another within a different MME & S-GW

VI) Authentication and Key Exchange (AKA) step-by-step process
	1) NAS Attach Request (UE -> eNB -> MME)
		• The UE sends the following to the eNB in attempt to connect to the network:
        1) IMSI: The UE’s unique identifier

  2) AUTH Data Request (MME -> AuC)
    • The MME sends the following data to the AuC to request authentication data:
        1) IMSI   : The receiving UE’s unique identifier
        2) SN_ID  : A sequence number to identify the request (similar to a TCP sequence number)

  3) AUTH Data Response (AuC -> MME)
    • The AuC sends the following data to the MME to respond to the authentication request:
        1) AUTN   : A value that is generated by XORing the RAND, KASME, SN_ID
        2) XRES   : The expected response from the UE
        3) KASME  : A shared key used to encrypt the NAS messages (available on both the UE and MME)
        4) RAND   : A random number generated by the network

  4) NAS Authentication Request (MME -> eNB -> UE)
    • The MME sends the following data to the UE to request authentication:
        1) RAND   : A random number generated by the network
        2) AUTN   : A value that is generated by XORing the RAND, KASME, SN_ID
        3) KSIASME: Generated by XORing the KASME and KSI (a 3-bit value incremented for every new authentication request)

  5) NAS Authentication Response (UE -> eNB -> MME)
    • The UE decrypts the received AUTN & RAND using the hardcoded shared KASME on the UE
    • Then it uses the decrypted RAND and AUTN to generate a RES
    • This RES is the encrypted using the hardcoded shared KASME on the UE and sent to the MME:
        1) RES   : The encrypted response sent to the network
    • If the RES maches the XRES on the MME, the UE is authenticated, else, not authenticated

  6) NAS SMC (MME -> eNB -> UE)
    • The confidentiality and integrity algorithms are negotiated between the UE and the MME
    • One of the three algorithms could be used for this purpose:
        1) 128-EEA1/EIA1: Based on the SNOW3G algorithm, which is a stream cipher
        2) 128-EEA2/EIA2: An AES block cipher with two modes: Counter Mode (CTM) for ciphering and GMAC for integrity
        3) 128-EEA3/EIA3: Based on ZUC, a stream cipher

  7) NAS Security Mode Complete (UE -> eNB -> MME)
    • The UE sends a message to the MME indicating that it has received/configured the security algorithms

  8) S1AP Initial Context Setup Request (MME -> eNB)
    • During this stage, the MME sends information about the UE to the eNB such cipher key (K), TMSI, etc.
    • This is beneficial during handovers as the eNB can use this information to setup the new RRC connection

  9) RRC SMC (eNB -> UE)
    • Additional security keys are negotiated between the UE and the eNB (such as MAC)
    • It also sends data about the current network details (cell info, network configurations, etc.)

  10) RRC Security Complete (UE -> eNB)
    • The UE sends a message to the eNB indicating that it has successfully configured the security algorithms

VII) Certificate Enrollment For Base Stations
  • A base station (eNB) obtains a certificate by the following steps:
    1) Send a request to the CA : The eNB sends its public key to the CA
    2) CA verifies the identity : The CA checks if the eNB is legit using the public key
    3) Issues the certificate   : The CA issues a certificate to the eNB signed by the CA's private key

  • There are two ways a base station (eNB) can obtain a certificate:
    1) RA/CA (Root/Certificate Authority) : By talking directly to the CA
    2) SEG (Security Gateway)             : By talking to the SEG, which then talks to the CA (like a proxy)

VIII) Threats & Characteristics Of LTE
    1) Threats
      A) Cloning of credentials     : SIM card cloning, obtaining IMSI number, etc.
      B) Physical tampering         : The eNB can be damaged by a physical attack (e.g. a hammer, fire)
      C) Fraudulent software update : Attackers can gain root access to eNB using a malicious software update
      D) Man-in-the-middle attacks  : Attacker can listen and change the data being sent between the UE and eNB
      E) DDOS Attacks               : A large number of fake users can be created to overload the network
      F) Eavesdropping              : An IMSI catcher can be used to eavesdrop on the network

    2) Characteristics
      A) Re-use of UMTS AKA: Same AKA process as in UMTS (3G)
      B) Use of USIM required                     : A special SIM card (USIM) is required for LTE
      C) Extended key hierarchy                   : A more complex key hierarchy than in 3G & provides greater security
      D) Possibility for longer keys              : The algorithms used in LTE (EIA 1/2/3) support longer keys
      E) Greater protection for backhaul          : The part that connects the eNB to the core network is more secure
      F) Integrated security for legacy networks  : Designed to work with 2G and 3G

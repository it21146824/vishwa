---
id: "Section 3 - Malware Infections"
aliases:
  - "Malware Infections"
  - "Malware Infections & Common Delivery Methods"
tags: []
---

# Malware Infections & Common Delivery Methods
+ **Threat vector**: The route in which an attacker reaches access to a victim machine.
    + *eg: Search the internet for machines with unpatched vulnerabilities*

+ **Attack vector**: Both the route and the method in which an attacker plans to access the machine and install malware.
    + *eg: Installing malware on a machine vulnerable to Log4Shell*

+ **Watering Holes**: Malware is placed on websites that you know your potentinal victims will access.

# Botnet & Zombies
+ **Botnets**: A network of infected machines that are controlled by a single attacker.
+ **Zombies**: The infected machines in a botnet.

# Active Interception & Privilege Escalation
## Active Interception
+ When an attacker intercepts a communication between two parties and modifies/reads the communication.
+ An example would be setting an evil twin access point to intercept traffic between a user and a legitimate access point.

## Privilege Escalation
+ When an attacker gains access to a system with low privileges and then elevates their privileges to gain access to more resources.

# Backdoors & Logic Bombs
## Backdoors
+ **Backdoors**: A method of bypassing authentication to gain access to a system.
    + *eg: A developer leaves a backdoor in their code to bypass authentication and gain root access to the system*
    + A **Remote Access Trojan (RAT)** is a type of backdoor that allows an attacker to remotely control a system.

## Logic Bombs & Easter Eggs
+ **Logic Bombs**: A piece of code intentionally inserted into a software system that will set off a malicious function when specified conditions are met
    + *eg: A developer leaves a logic bomb in their code to delete all files on the system on a specific date*.
+ **Easter Eggs**: A harmless joke or message hidden in software code.
    + *eg: The Google Chrome Dinosaur Game*

# Symptoms of Infection
 + The following are some common symptoms that your machine contains malware:
    1. Your computer is running slow.
    2. Computer stops responding or locks up often.
    3. Your computer crashes often *(BSOD)*.
    4. Strange noises occur from the computer.
    5. Unusual error messages.
    6. New desktop icons start appearing or desktop icons start missing.
    7. Double file extensions *(eg: .txt.exe)*.
    8. Anti-virus does not work.
    9. New files are added of files are deleted.
    10. System restore is not working.

# Removing Malware
1. Identify symptoms of a malware infection.
2. Quarantine the infected system.
3. Disable system restore.
4. Remediate the infected system.
5. Schedule scans and run updates.
6. Enable system restore & create a new restore point.
7. Provide end-user awareness training.

+ **In case of a boot-sector virus**, you will have to boot from an external device (USB Live Boot) and then run a scan.
    + This is because the virus is loaded into memory when the system boots up, and therefore cannot be removed by an anti-virus running on the system.

# Preventing Malware
1. **Preventing worms/trojans/viruses**: Use a anti-malware solution.
2. **Preventing adware**: Use an anti-spyware solution and set browser security settings to high.
3. **Preventing rootkits**: Scan from an external drive or reimage (reinstall) the system.
4. **Preventing Spam**: Ensure that your email servers are not configured as open-relays and provide training.

+ In summary, all of this can be summarized as follows:
    1. Update your anti-malware software & automatically scan your computer.
    2. Update your operation system and patch your applications regularly.
    3. Educate your end-users on safe internet surfing practices.

# Malware Exploitation
+ **Exploit Technique**: A fileless method of taking advantage of a vulnerability in a system *(eg: buffer overflow, SQL Injection)*

+ The following are some steps in which a system can be taken over by an attacker:
    1. **Dropper or Downloader**: The process of tricking a user to download a lightweight script that then downloads the actual malware shellcode.
        + **Dropper**: Malware designed to install itself on a system *(eg: macro-enabled documents)*.
        + **Downloader**: The downloading tool used by the dropper to download the actual malware *(eg: wget)*.
        + **Shellcode/Malware Code**: A small piece of code that is used as the payload for the malware.
        + **Code Injection**: Exploiting the shellcode as a separate process with a separate process ID.
            + **Masquerading**: An executable will be replaced with a malicious executable with the same name.
            + **DLL Injection**: A malicious DLL will be injected into a legitimate process.
            + **DLL Sideloading**: A legitimate DLL will be replaced with a malicious DLL.
            + **Process Hollowing**: The memory of a legitimate process will be replaced with the shellcode.

    2. **Maintain Access**: The process of maintaining access to the system by installing a Remote Access Trojan (RAT).
    3. **Strengthen Access**: Using the installed Remote Access Trojan (RAT), the attacker performs lateral movement to gain more control over the systems.
    4. **Actions on Objectives**: Perform the task that the attacker originally came to do.
    5. **Concealment**: The process of hiding the malware and the attacker's tracks by deleting log files.

+ **Living off the land**: Using legitimate tools to perform malicious actions, thereby making it harder to detect malicious activities.
    + *eg: Using PowerShell to download a malicious file*
